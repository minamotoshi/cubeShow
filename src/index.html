<!DOCTYPE html>
<html lang="zh">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
	<title>手Q环境AR效果Demo</title>
</head>

<body>
	<div id="ar-loading">
		<div class="loadingbar"></div>
		<div class="percent">loading...</div>
	</div>
	<div id="ar-index" style="z-index:99;display:none;">
		<a href="javascript:;">launch</a>
	</div>
	<div id="ar-recognition" style="z-index:99;display:none;">
		<canvas id="ar-game"></canvas>
		<div id="ar-info">
			<div class="arrow-left"><img src="./images/page/arrow.png"/></div>
			<div class="arrow-right"><img src="./images/page/arrow.png"/></div>
			<div class="tips"><img src="./images/page/tips.png"/></div>
		</div>
		<div id="ar-recognition-result" style="display:none">
			<div id="ar-result-cartoon">
				<canvas id="ar-cartoon" width="720" height="1560" style="width:100%;height:100%"></canvas>
			</div>
			<div id="ar-result-guide">
				<div class="slogan"><img src=""/></div>
				<div class="btn"><a href="#"><img src="./images/page/btn.png"/></a></div>
			</div>
		</div>
	</div>
	<div id="ar-back-btn" style="display:none" ><img class="slogan" src="./images/page/back.png"/></div>
	<script>
		
var _game = null,
	_cartoon = null;
window.addEventListener('load', function(e){
	CubeShow.Preload.load(progress, complete);
});
function progress(e){
	document.querySelector("#ar-loading .percent").innerHTML = Math.floor(e.loaded * 10000)/100 + "%";
}
function complete(){
	var game = document.getElementById("ar-game");
	_game = new CubeShow.main(game);
	_game.addEventListener(CubeShow.Event.CUBE_CLICK, onCubeClick);
	_cartoon = new CubeShow.Cartoon(document.getElementById("ar-cartoon"));
	document.getElementById("ar-loading").style.display = "none";
	document.getElementById("ar-index").style.display = "";
	document.getElementById("ar-index").addEventListener("click", onLaunch);
}
function onLaunch(){
	document.getElementById("ar-index").style.display = "none";
	document.getElementById('ar-info').style.display = '';
	document.getElementById('ar-back-btn').addEventListener("click", onback);	
	document.getElementById("ar-recognition").style.display = "";
	_game.launch();
}
function onback(){
	document.getElementById('ar-info').style.display = '';
	document.getElementById('ar-back-btn').style.display = 'none';
	document.getElementById("ar-recognition-result").style.display = "none";
	_game.replay()
}
function onCubeClick(e){
	let name = e.data.name;
	document.getElementById('ar-info').style.display = 'none';
	document.getElementById('ar-back-btn').style.display = '';
	document.getElementById("ar-recognition-result").style.display = "";
	document.getElementById('ar-result-cartoon').style.display = '';
	document.querySelector("#ar-result-guide .slogan img").src = "images/" + name + "-slogan.png";
	if(name == "Jeans"){
		_game.paper();
		document.getElementById('ar-result-cartoon').style.display = 'none';
	}else{
		//CubeShow.Preload.add({id:"ut_atlas_", src:"ut_atlas_"});
		_cartoon.play(name);
	}
}
	</script>
</body>

</html>
